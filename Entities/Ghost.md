# üëª Entity: Ghost Enemy

> **–¢–∏–ø:** Flying Enemy  
> **–°–∫—Ä–∏–ø—Ç:** `Scripts/EnemiesAI/Fly Enemy/GhostController.cs`  
> **AI:** MonsterLove StateMachine (FSM)

---

## ‚úÖ Current (As-Is)
- –õ–µ—Ç–∞—é—â–∏–π –≤—Ä–∞–≥-–ø—Ä–∏–∑—Ä–∞–∫
- FSM: Sleep ‚Üí Patrol ‚Üí Stalk (Orbit) ‚Üí Attack ‚Üí Recover
- –ê—Ç–∞–∫–∞ "—Å–∫–≤–æ–∑—å" –∏–≥—Ä–æ–∫–∞ (pass-through)
- –£—è–∑–≤–∏–º —Ç–æ–ª—å–∫–æ –≤ —Ñ–∞–∑–µ Recover
- Kinematic Rigidbody, –±–µ–∑ –≥—Ä–∞–≤–∏—Ç–∞—Ü–∏–∏
- –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Malbers MDamageable

## üß© Known Issues / TODO
- [ ] –ò–Ω–æ–≥–¥–∞ –∑–∞—Å—Ç—Ä–µ–≤–∞–µ—Ç –Ω–∞ –≥–µ–æ–º–µ—Ç—Ä–∏–∏ –ø—Ä–∏ orbit
- [ ] –î–æ–±–∞–≤–∏—Ç—å VFX –ø—Ä–∏ —Ñ–∞–∑–µ Recover
- [ ] –£–ª—É—á—à–∏—Ç—å targeting –Ω–∞ –¥–≤–∏–∂—É—â–µ–≥–æ—Å—è –∏–≥—Ä–æ–∫–∞

## üí° Notes
- `isTrigger` –∫–æ–ª–ª–∞–π–¥–µ—Ä—ã —Ñ–∞–∑—è—Ç—Å—è –≤–æ –≤—Ä–µ–º—è Attack
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –≥–∏—Å—Ç–µ—Ä–µ–∑–∏—Å –¥–ª—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏/–¥–µ–∞–∫—Ç–∏–≤–∞—Ü–∏–∏
- –¢—Ä–µ–±—É–µ—Ç Rigidbody (kinematic, no gravity)

---

## üìä Gameplay Flow

| Player Does | Ghost Does |
|-------------|------------|
| –î–∞–ª–µ–∫–æ –æ—Ç –ø—Ä–∏–∑—Ä–∞–∫–∞ | Sleep / Patrol |
| –í—Ö–æ–¥–∏—Ç –≤ activateRadius | –ü–µ—Ä–µ—Ö–æ–¥ –≤ Stalk |
| –ù–∞—Ö–æ–¥–∏—Ç—Å—è —Ä—è–¥–æ–º | Orbit –≤–æ–∫—Ä—É–≥ –∏–≥—Ä–æ–∫–∞ |
| –ü–æ—Å–ª–µ orbit –≤—Ä–µ–º–µ–Ω–∏ | Attack (–ø—Ä–æ–ª—ë—Ç —Å–∫–≤–æ–∑—å) |
| –ü–æ—Å–ª–µ –∞—Ç–∞–∫–∏ | Recover (—É—è–∑–≤–∏–º!) |
| –í—ã—Ö–æ–¥–∏—Ç –∏–∑ deactivateRadius | Return ‚Üí Patrol |

---

## üß† AI States (FSM)


| State | –û–ø–∏—Å–∞–Ω–∏–µ | –ü–µ—Ä–µ—Ö–æ–¥ |
|-------|----------|---------|
| **Sleep** | –ë–µ–∑–¥–µ–π—Å—Ç–≤–∏–µ | ‚Üí Patrol (—Ç—Ä–∏–≥–≥–µ—Ä/–¥–∏—Å—Ç–∞–Ω—Ü–∏—è) |
| **Patrol** | –•–æ–¥–∏—Ç –ø–æ patrolPoints | ‚Üí Stalk (–∏–≥—Ä–æ–∫ –±–ª–∏–∑–∫–æ) |
| **Stalk** | Orbit –≤–æ–∫—Ä—É–≥ –∏–≥—Ä–æ–∫–∞ | ‚Üí Attack (–ø–æ—Å–ª–µ orbitTime) |
| **Attack** | –ü—Ä–æ–ª—ë—Ç —Å–∫–≤–æ–∑—å –∏–≥—Ä–æ–∫–∞ | ‚Üí Recover |
| **Recover** | –•–∞–æ—Ç–∏—á–Ω–æ–µ –¥–≤–∏–∂–µ–Ω–∏–µ, —É—è–∑–≤–∏–º | ‚Üí Patrol/Return |
| **Return** | –í–æ–∑–≤—Ä–∞—Ç –∫ –Ω–∞—á–∞–ª—å–Ω–æ–π —Ç–æ—á–∫–µ | ‚Üí Patrol |

---

## ‚öôÔ∏è Parameters

### Targeting
| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|----------|----------|
| `target` | Transform | –¶–µ–ª—å (–∏–≥—Ä–æ–∫) |
| `hoverHeightOffset` | 1.0 | –°–º–µ—â–µ–Ω–∏–µ –ø–æ –≤—ã—Å–æ—Ç–µ |

### Activation (Hysteresis)
| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|----------|----------|
| `activateRadius` | 12.0 | –†–∞–¥–∏—É—Å –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ |
| `deactivateRadius` | 18.0 | –†–∞–¥–∏—É—Å –¥–µ–∞–∫—Ç–∏–≤–∞—Ü–∏–∏ |
| `activationTrigger` | SphereCollider | –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π —Ç—Ä–∏–≥–≥–µ—Ä |

### Patrol
| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|----------|----------|
| `patrolPoints` | List<Transform> | –¢–æ—á–∫–∏ –ø–∞—Ç—Ä—É–ª—è |
| `patrolArriveDist` | 0.5 | –¢–æ—á–Ω–æ—Å—Ç—å –ø—Ä–∏–±—ã—Ç–∏—è |
| `patrolWaitRange` | (0.5, 1.5) | –ü–∞—É–∑–∞ –Ω–∞ —Ç–æ—á–∫–µ |

### Movement
| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|----------|----------|
| `maxSpeed` | 6.0 | –ú–∞–∫—Å. —Å–∫–æ—Ä–æ—Å—Ç—å |
| `acceleration` | 24.0 | –£—Å–∫–æ—Ä–µ–Ω–∏–µ |
| `turnSpeed` | 720¬∞ | –°–∫–æ—Ä–æ—Å—Ç—å –ø–æ–≤–æ—Ä–æ—Ç–∞ |
| `jitterYawDeadZone` | 0.25 | –ê–Ω—Ç–∏-–¥—Ä–æ–∂—å |

### Avoidance
| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|----------|----------|
| `obstacleMask` | LayerMask | –°–ª–æ–∏ –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏–π |
| `avoidProbeDistance` | 1.5 | –î–∏—Å—Ç–∞–Ω—Ü–∏—è –ø—Ä–æ–≤–µ—Ä–∫–∏ |
| `avoidStrength` | 6.0 | –°–∏–ª–∞ —É–∫–ª–æ–Ω–µ–Ω–∏—è |

### Stalk/Orbit
| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|----------|----------|
| `orbitRadius` | 3.5 | –†–∞–¥–∏—É—Å –æ—Ä–±–∏—Ç—ã |
| `orbitLinearSpeed` | 3.5 | –°–∫–æ—Ä–æ—Å—Ç—å –ø–æ –æ—Ä–±–∏—Ç–µ |
| `orbitRadiusStrength` | 2.0 | –°–∏–ª–∞ —É–¥–µ—Ä–∂–∞–Ω–∏—è —Ä–∞–¥–∏—É—Å–∞ |
| `orbitTimeRange` | (1.0, 2.2) | –í—Ä–µ–º—è –æ—Ä–±–∏—Ç—ã –¥–æ –∞—Ç–∞–∫–∏ |

### Attack
| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|----------|----------|
| `attackDuration` | 0.45 —Å | –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø—Ä–æ–ª—ë—Ç–∞ |
| `attackSpeed` | 8.5 | –°–∫–æ—Ä–æ—Å—Ç—å –∞—Ç–∞–∫–∏ |
| `passThroughBehindOffset` | 1.6 | –°–º–µ—â–µ–Ω–∏–µ –∑–∞ —Å–ø–∏–Ω—É —Ü–µ–ª–∏ |

---

## üîó Dependencies

| –°–∏—Å—Ç–µ–º–∞ | –°–≤—è–∑—å |
|---------|-------|
| **MonsterLove StateMachine** | FSM –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ |
| **Malbers MDamageable** | –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π —É—Ä–æ–Ω |
| **Rigidbody** | Kinematic, –±–µ–∑ –≥—Ä–∞–≤–∏—Ç–∞—Ü–∏–∏ |
| **Colliders** | –§–∞–∑–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏ –∞—Ç–∞–∫–µ |
| **Player Transform** | Target –¥–ª—è —Å–ª–µ–¥–æ–≤–∞–Ω–∏—è |

---

## üé¨ –¶–∏–∫–ª –±–æ—è

> **–ö–ª—é—á–µ–≤–æ–π –º–æ–º–µ–Ω—Ç:** –ü—Ä–∏–∑—Ä–∞–∫ —É—è–∑–≤–∏–º **–¢–û–õ–¨–ö–û** –≤ —Ñ–∞–∑–µ Recover!

Patrol ‚Üí Stalk (orbit) ‚Üí Attack (pass-through) ‚Üí **Recover (—É—è–∑–≤–∏–º!)** ‚Üí Patrol
